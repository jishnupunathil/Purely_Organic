<%-include('../partials/userHeader.ejs') %>
<head>
<!-- Font Icon -->
      <link rel="stylesheet" href="/fonts/material-icon/css/material-design-iconic-font.min.css">

      <!-- Main css -->
      <link rel="stylesheet" href="/cssSL/style.css">
 </head>
<section>
    <main class="main">
      
  
      <div
        class="login-page bg-image pt-8 pb-8">
        <div class="container">
          <div class="form-box">
            <div class="form-tab">
              <ul class="nav nav-pills nav-fill" role="tablist">
                <li class="nav-item">
                  <h2>Change Password</h2>
                </li>
              </ul>
              <br>
  
              <!-- REGISTRATION FORM -->
              <div
                class="tab-pane fade show active"
                id="register-2"
                role="tabpanel"
                aria-labelledby="register-tab-2"
              >
                <form
                  id="userForm"
                  action="/user/change-password"
                  id="userForm"
                  method="post"
                >
                  <div class="form-group">
                    
                    <input
                      type="password"
                      class="form-control"
                      style="width: 40%;"
                      id="registerPassword"
                      name="changedPassword"
                      placeholder="Password"
                      required
                      onblur="validatePassword()"
                    /><br>
                    <label
                      id="password-error"
                      class="errorLabel text-danger pt-5"
                      for="registerPassword"
                    ></label>
                  </div>
                  <!-- End .form-group -->
  
                  <div class="form-group">
                    
                    <input
                      type="password"
                      class="form-control"
                      style="width: 40%;"
                      id="confirmPassword"
                      required
                      placeholder="Confirm password"
                      onblur="checkPassword()"
                    /><br>
                    <label
                      id="confirmPassword-error"
                      class="errorLabel text-danger pt-5"
                      
                      for="confirmPassword"
                    ></label>
                  </div>
                  <!-- End .form-group -->
  
                  <div class="form-footer">
                    <button
                      id="button"
                      name="button"
                      type="submit"
                      class="btn btn-success"
                    >
                      Change Password
                    </button>
                    <label
                      id="submit-error"
                      class="errorLabel text-danger pt-5"
                      for="button"
                    ></label>

                    <%if(message){%>
                        <p style="color: red;"> <%=message%></p>
                    <%}%>
                   
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </section>
  <%- include('../partials/userFooter.ejs')%>
  <script>
    const passwordError = document.getElementById("password-error");
    const confirmPasswordError = document.getElementById("confirmPassword-error");
  
    function validatePassword() {
      var password = document.getElementById("registerPassword").value;
      if (password == "") {
        passwordError.innerHTML = "Password cannot be blank";
        return false;
      }
      
      if (password.length < 6) {
        passwordError.innerHTML = "Atleast 6 characters";
        return false;
      }

      passwordError.innerHTML = "";
      return true;
    }
  
    function checkPassword() {
      var password = document.getElementById("registerPassword").value;
      var Cpassword = document.getElementById("confirmPassword").value;
      if (password !== Cpassword) {
        confirmPasswordError.innerHTML = "Password Missmatching";
        return false;
      }
      confirmPasswordError.innerHTML = "";
      return true;
    }
    function validateForm() {
      if (!validatePassword() || !checkPassword()) {
        submitError.innerHTML = "Please fix all errors to submit.";
        setTimeout(function () {
          submitError.style.display = "none";
        }, 3000);
        return false;
      } else {
        document.getElementById("userForm").submit();
      }
    }
  </script>