<%-include('../partials/userHeader.ejs')%> 
<section class="hero hero-normal">
    <div class="container">
        <div class="row">
            <div class="col-lg-1">
                <% allBanner.forEach(function(banner) { %>
                    <%if(banner.bname==='ogani logo'){%>
                        <div class="header__logo">
    
                            <% if (user){%>
    
                                <a href="/user/index"><img src="<%=banner.bimages%>" alt=""></a>
                            <%}else{%>
                                
                                <a href="/"><img src="<%=banner.bimages%>" alt=""></a>
                            <%}%>
                            
                        </div>
                        <%}%>
                        <%})%>
            </div>
            <div class="col-lg-9">
                <nav class="header__menu">
                    <div class="hero__search">
                        <div class="hero__search__form">
                            <form action="#">
                                <div class="hero__search__categories">
                                    All Categories
                                    <span class="arrow_carrot-down"></span>
                                </div>
                                <input type="text" placeholder="What do yo u need?">
                                <button type="submit" class="site-btn">SEARCH</button>
                            </form>
                        </div>
                        <div class="hero__search__phone">
                            <div class="hero__search__phone__icon">
                                <i class="fa fa-phone"></i>
                            </div>
                            <div class="hero__search__phone__text">
                                <h5>+9496959109</h5>
                                <span>support 24/7 time</span>
                            </div>
                        </div>
                    </div>
                </nav>
            </div>
            <div class="col-lg-2">
                <div class="header__cart">
                    <ul>
                        <li><a href="#"><i class="fa fa-heart"></i> </a></li>
                            <!-- <span>1</span></a></li> -->
                        <li><a href="/user/getCart"><i class="fa fa-shopping-bag"></i><span><%=cartCount%></span></a></li>
                             <!-- <span>3</span></a></li> -->
                    </ul>
                    <!-- <div class="header__cart__price">item: <span>₹150.00</span></div> -->
                </div>
            </div>
        </div>
        <div class="humberger__open">
            <i class="fa fa-bars"></i>
        </div>
        
        
    
            <!-- <div class="col-lg-2">
                <div class="hero__categories">
                    <div class="hero__categories__all">
                        <i class="fa fa-bars"></i>
                        <span>All departments</span>
                    </div>
                    <ul>
                        <li><a href="#">Fresh Meat</a></li>
                        <li><a href="#">Vegetables</a></li>
                        <li><a href="#">Fruit & Nut Gifts</a></li>
                        <li><a href="#">Fresh Berries</a></li>
                        <li><a href="#">Ocean Foods</a></li>
                        <li><a href="#">Butter & Eggs</a></li>
                        <li><a href="#">Fastfood</a></li>
                        <li><a href="#">Fresh Onion</a></li>
                        <li><a href="#">Papayaya & Crisps</a></li>
                        <li><a href="#">Oatmeal</a></li>
                        <li><a href="#">Fresh Bananas</a></li>
                    </ul>
                </div>
            </div> -->
        </div>
    </div>
</section>
    <!-- Hero Section End -->

    <!-- Breadcrumb Section Begin -->
    <section class="breadcrumb-section set-bg" data-setbg="/img/breadcrumb.jpg">
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <div class="breadcrumb__text">
                        <h2>Checkout</h2>
                        
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Breadcrumb Section End -->
    <div>



    </div>

    <!-- Checkout Section Begin -->
   
    <section class="checkout spad">
        <div class="container">
            <div class="checkout__form">
                <h4>Billing Details</h4>
                <form  id="checkout-form">
                    <div class="row">
                        <div class="col-lg-8 col-md-6">
                            
                            
                            <div id="" class="card my-3 col-md-8">
                                <%if(separateAddresses.length>0){%>
                                <%separateAddresses.forEach(function(address){%>
                                <div class="card-header d-flex">
                                    <div class="form-check">
                                        <input class="form-check-input" checked value="<%=address._id%>" type="radio" name="address" id="flexRadioDefault1" checked readonly />
                                        <label class="form-check-label" for="flexRadioDefault1">
                                            <h5 class="mb-0">Billing Address</h5>
                                        </label>
                                    </div>
                                    
                                </div>
                                <div class="card-body">
                                    
                                    <address >
                                        <%=address.address%> ,
                                    <%=address.city%> <br>
                                    <%=address.pincode%> ,
                                    <%=address.state%>, <br>
                                    <%=address.phone%> ,
                                    <%=address.email%>
                                    
                                    
                                </address>
                                
                                <div class="d-flex mt-2">
                                    <a href="/user/editAddress/<%=address._id%>" style="text-decoration: none;color:rgb(250, 250, 250);border: 1px solid black;
                                    width:75px;height: 35px;background-color: rgb(57, 102, 236);font-size:large;font-weight: bold;padding-left: 20px;padding-top: 5px;border-radius: 2px;">Edit</a>
                  
                                  </div>
                                  
                                  <label for="diff-acc">
                                      <!-- <input type="checkbox" id="diff-acc"> -->
                                      <!-- <span class="checkmark"></span> -->
                                    </label>
                                    
                                </div>
                                <%})%>
                                <hr>
                                <div>
                                    Shipping to a Different address!<a href="/user/newAddress">Click here</a>
                                </div>
                            <%}else{%>
                                <label for="diff-acc">
                                    No Saved address Found! To add One  <a href="/user/newAddress">Click here</a>
                                        <!-- <input type="checkbox" id="diff-acc"> -->
                                        <!-- <span class="checkmark"></span> -->
                                    </label>
                                    <%}%>
                                </div>
                                <input type="text" value="<%=user._id%>" name="userId" hidden>
                                
                                
                            </div>
                        <div class="col-lg-4 col-md-6">
                            <div class="checkout__order">
                                <h4>Your Order</h4>
                                <div class="checkout__order__products">Products <span>Total</span></div>
                                <% productDetails.forEach((prod)=>{%>
                                    <ul>
                                        <li><%=prod.name%><span>₹<%=prod.totalPrice%></span></li>
                                    </ul>
                                    <%})%>
                                <div class="checkout__order__subtotal" >Subtotal <span>₹<%=subTotal%></span></div>
                                <div class="checkout__order__total" id="totalPrice" name="totalPrice">Total <span>₹<%=total%></div>
                                <div class="custom-control custom-radio">
                                    <input id="cod" value="cash_on_delivery" name="paymentMethod" type="radio" class="custom-control-input"/>
                                    <label class="custom-control-label" for="cod">Cash On Delivery</label>
                                </div>
                                <div class="custom-control custom-radio">
                                    <input id="online-payment" value="online_payment" name="paymentMethod" type="radio" class="custom-control-input"/>
                                    <label class="custom-control-label" for="online-payment">Online Payment</label>
                                  </div>
                                <button type="submit" class="site-btn">PLACE ORDER</button>
                            </div>
                        </div>
                    </div>  
                </form>
            </div>
        </div>
        <div>
        </div>
    </section>

    
    
                                <!-- <div class="checkout__input__checkbox"> -->
                                    
                                <!-- </div> -->
                                
                            </div>
                            
                            </div>
                        </div>  
                    </form>
                </div>
            </div>
            <div>
            </div>
        </section>
        
    <!-- Checkout Section End -->
 
      
      <!-- edit address -->
      



    <%- include('../partials/userFooter.ejs')%>

    <script>
        $("#checkout-form").submit((e)=>{
            e.preventDefault()
            $.ajax({
                url:'/user/place-order',
                method:'post', 
                data:$('#checkout-form').serialize(),
                success:(response)=>{
                    alert(response)
                }
            })
        })


         function deleteAddress(addressId){
        Swal.fire({
        title: 'Are you sure?',
        text: "You won't be able to revert this!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
       confirmButtonText: 'Yes, delete Product!'
     }).then((result) => {
       if (result.isConfirmed) {
     
     $.ajax({
       url:"/user/deleteAddress/"+addressId,
       method:"post",
       success: function() 
       {
   
             // Reload the page
             location.reload();
       }
   })
       }
   })
   }
    </script>
